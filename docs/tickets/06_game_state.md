# チケット: ゲーム状態管理

## 概要
ゲームの状態（開始前、プレイ中、ゲームオーバー）を管理し、状態遷移とメッセージ表示を制御する。

## 実装内容
- ゲーム状態の定義（WAITING、PLAYING、GAME_OVER）
- 状態遷移の管理
- 各状態でのメッセージ表示
- Enterキーによる状態遷移処理

## ToDo（TDD実装順）

### 1. GameStateクラスのテストを作成
- [ ] tests/test_game_state.pyを作成
- [ ] GameStateクラスの存在テストを記述
- [ ] 初期状態がWAITINGであることのテストを追加
- [ ] テストを実行して失敗することを確認

### 2. GameStateクラスの基本実装
- [ ] src/game/state/__init__.pyを作成
- [ ] src/game/state/game_state.pyを作成
- [ ] GameStateクラスを定義
- [ ] State列挙型を定義（WAITING、PLAYING、GAME_OVER）
- [ ] 初期状態をWAITINGに設定
- [ ] テストを実行して成功することを確認

### 3. 状態遷移のテストを作成
- [ ] set_state()メソッドのテストを追加
- [ ] get_state()メソッドのテストを追加
- [ ] 状態変更が正しく反映されることのテストを追加
- [ ] テストを実行して失敗することを確認

### 4. 状態遷移を実装
- [ ] set_state(new_state)メソッドを実装
- [ ] get_state()メソッドを実装
- [ ] current_state属性で状態を管理
- [ ] テストを実行して成功することを確認

### 5. 状態別処理のテストを作成
- [ ] is_waiting()メソッドのテストを追加
- [ ] is_playing()メソッドのテストを追加
- [ ] is_game_over()メソッドのテストを追加
- [ ] テストを実行して失敗することを確認

### 6. 状態別処理を実装
- [ ] is_waiting()メソッドを実装
- [ ] is_playing()メソッドを実装
- [ ] is_game_over()メソッドを実装
- [ ] テストを実行して成功することを確認

### 7. ゲーム開始処理のテストを作成
- [ ] start_game()メソッドのテストを追加
- [ ] WAITINGからPLAYINGへの遷移テストを追加
- [ ] GAME_OVERからWAITINGへのリセットテストを追加
- [ ] テストを実行して失敗することを確認

### 8. ゲーム開始処理を実装
- [ ] start_game()メソッドを実装
- [ ] 状態をPLAYINGに変更
- [ ] ゲーム開始時の初期化処理を追加
- [ ] テストを実行して成功することを確認

### 9. ゲーム終了処理のテストを作成
- [ ] end_game()メソッドのテストを追加
- [ ] PLAYINGからGAME_OVERへの遷移テストを追加
- [ ] 最終スコアの保存テストを追加
- [ ] テストを実行して失敗することを確認

### 10. ゲーム終了処理を実装
- [ ] end_game(final_score)メソッドを実装
- [ ] 状態をGAME_OVERに変更
- [ ] final_score属性に最終スコアを保存
- [ ] テストを実行して成功することを確認

### 11. リセット処理のテストを作成
- [ ] reset()メソッドのテストを追加
- [ ] GAME_OVERからWAITINGへの遷移テストを追加
- [ ] スコアがクリアされることのテストを追加
- [ ] テストを実行して失敗することを確認

### 12. リセット処理を実装
- [ ] reset()メソッドを実装
- [ ] 状態をWAITINGに変更
- [ ] スコアやタイマーのリセット処理を追加
- [ ] テストを実行して成功することを確認

### 13. メッセージ取得のテストを作成
- [ ] get_message()メソッドのテストを追加
- [ ] WAITING時のメッセージテストを追加
- [ ] GAME_OVER時のメッセージテストを追加
- [ ] テストを実行して失敗することを確認

### 14. メッセージ取得を実装
- [ ] get_message()メソッドを実装
- [ ] WAITING: "Press Enter to Start"を返す
- [ ] GAME_OVER: "Game Over"を返す
- [ ] PLAYING: Noneを返す
- [ ] 全テストを実行して成功することを確認

## 完了条件
- [ ] 3つの状態が正しく管理される
- [ ] 状態遷移が適切に動作する
- [ ] 各状態で適切なメッセージが表示される
- [ ] pytest tests/test_game_state.pyが全てパスする